<!DOCTYPE html>
<html lang="ko">
<head>
    <meta name="color-scheme" content="dark light">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Goal Dashboard</title>
    
    <script src="https://unpkg.com/react@18/umd/react.development.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js" crossorigin></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>

    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700&display=swap" rel="stylesheet">

    <style>
        body {
            font-family: 'Noto Sans KR', sans-serif;
            background-color: transparent;
            margin: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
        }
        
        .widget-container {
    /* [ë³µêµ¬] ê³¨ ìœ„ì ¯ì€ ì„¸ë¡œë¡œ ìŒ“ì—¬ì•¼ í•˜ë¯€ë¡œ width ê³ ì • */
    width: 440px;
    height: 310px;
    background: rgba(255, 255, 255, 0.45);
    backdrop-filter: blur(25px);
    border-radius: 20px;
    border: 1px solid rgba(255, 255, 255, 0.8);
    box-shadow: 0 10px 40px rgba(216, 180, 254, 0.1);

    /* [í•µì‹¬ ìˆ˜ì •] row(ê°€ë¡œë°°ì¹˜) -> column(ì„¸ë¡œìŒ“ê¸°) */
    display: flex;
    flex-direction: column; 

    /* [ë³µêµ¬] ë‚´ë¶€ ì—¬ë°±ê³¼ ê°„ê²© ë‹¤ì‹œ ì‚´ë¦¬ê¸° (ì••ì¶• ë²„ì „) */
    padding: 17px 20px;
    gap: 6px;
    
    overflow: hidden;
    color: #334155;
}
        .section-title {
            font-size: 11px;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 0.05em;
    /* [ìˆ˜ì •] ë§ˆì§„ 8px -> 4px */
    margin-bottom: 4px;
    display: flex;
    align-items: center;
    gap: 6px;
        }

        /* Custom Progress Bar */
        .progress-bg {
            height: 10px;
            background: rgba(255, 255, 255, 0.5);
            border-radius: 99px;
            overflow: hidden;
            position: relative;
        }
        .progress-fill {
            height: 100%;
            border-radius: 99px;
            transition: width 1.5s cubic-bezier(0.4, 0, 0.2, 1);
        }

        /* Glass Cards */
        .glass-card {
    background: rgba(255, 255, 255, 0.4);
    border: 1px solid rgba(255, 255, 255, 0.6);
    border-radius: 16px;
    /* [ìˆ˜ì •] íŒ¨ë”© 12px -> 8px, ì¢Œìš° 14pxë¡œ ë¯¸ì„¸ ì¡°ì • */
    padding: 8px 14px;
}
    </style>
    
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        purple: { 300: '#d8b4fe', 100: '#f3e8ff' },
                        sky: { 300: '#7dd3fc', 100: '#e0f2fe' },
                        yellow: { 200: '#fef08a', 100: '#fef9c3' },
                        slate: { 400: '#94a3b8', 50: '#f8fafc' }
                    }
                }
            }
        }
    </script>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // â˜… ì›Œì»¤ ì£¼ì†Œë¥¼ ì—¬ê¸°ì— ì…ë ¥í•˜ì„¸ìš”!
        const WORKER_URL = "https://project-worker.moonkelly601.workers.dev"; 

        const GoalWidget = () => {
            const [data, setData] = useState(null);
            const [loading, setLoading] = useState(true);

            useEffect(() => {
                const fetchData = async () => {
                    try {
                        // [ìˆ˜ì •] ì‹¤ì œ ì›Œì»¤ì™€ í†µì‹  ì‹œì‘
                        const res = await fetch(WORKER_URL);
                        const json = await res.json();
                        
                        setData(json);
                        setLoading(false); // [ì¤‘ìš”] ë¡œë”© ìƒíƒœ í•´ì œ

                    } catch (e) {
                        console.error("ë°ì´í„° ë¡œë”© ì‹¤íŒ¨:", e);
                        setLoading(false); // ì—ëŸ¬ê°€ ë‚˜ë„ ë¡œë”©ì€ êº¼ì¤Œ
                    }
                };
                fetchData();
            }, []);

            if (loading) return <div className="widget-container items-center justify-center opacity-70"><div className="text-sm font-medium text-slate-400">Loading System...</div></div>;
            if (!data) return <div className="widget-container">Error</div>;

            const { goals, progress, feedback } = data;
            
            return (
                <div className="widget-container">
                    
                    {/* 1. Annual Keywords (Purple - Priority 1) */}
                    <div>
                        <div className="section-title text-purple-300">
                            <svg className="w-3.5 h-3.5" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/></svg>
                            2026 Main Theme
                        </div>
                        <div className="flex gap-2">
                            {goals.keywords.map((k, i) => (
                                <div key={i} className="flex-1 bg-purple-100/50 border border-purple-300/30 rounded-xl py-2 px-1 text-center">
                                    <span className="text-[12px] font-bold text-slate-600 word-keep-all block">{k}</span>
                                </div>
                            ))}
                        </div>
                    </div>

                    {/* 2. Monthly Goal (Sky Blue - Priority 2) */}
            <div className="glass-card bg-sky-100/20 border-sky-300/40">
                <div className="flex justify-between items-end mb-1">
                    <div className="section-title text-sky-300 mb-0">Monthly Objective</div>
                    {/* [ìˆ˜ì •] í¼ì„¼íŠ¸ í…ìŠ¤íŠ¸ ì‚­ì œë¨ */}
                </div>
                <div className="text-sm font-medium text-slate-700 mb-2">{goals.monthly.text}</div>
                
                {/* [ìˆ˜ì •] ì—ë„ˆì§€ ë°” í˜•íƒœ: 10ì¹¸ ë¶„í• , ë†’ì´ ì–‡ê²Œ(h-1.5), 10%ë‹¹ 1ì¹¸ */}
                <div className="flex gap-1">
                    {[...Array(10)].map((_, i) => (
                        <div key={i} className={`flex-1 h-1.5 rounded-full transition-all duration-500 ${
                            i < Math.round(progress.percent / 10) 
                            ? 'bg-sky-300 shadow-[0_0_6px_rgba(125,211,252,0.8)]' 
                            : 'bg-slate-200/50'
                        }`}></div>
                    ))}
                </div>
            </div>

            {/* 3. Weekly Goal (Yellow - Priority 3) */}
            <div className="glass-card bg-yellow-100/20 border-yellow-200/60">
                    <div className="section-title text-yellow-200/90" style={{ color:'#dcb028' }}>Weekly Focus</div>
                    <div className="flex items-center justify-between">
                    <span className="text-sm font-medium text-slate-700">{goals.weekly.text}</span>
                    <div className="flex gap-1">
                            <div key={i} className={`w-2 h-6 rounded-sm transition-all duration-500 ${
                                i < Math.round((progress.percent / 100) * 7) 
                                ? 'bg-yellow-200 shadow-[0_0_5px_rgba(253,224,71,0.6)]' 
                                : 'bg-slate-200/50'
                            }`}></div>
                    </div>
            </div>

            {/* 4. AI Feedback */}
            {/* [ìˆ˜ì •] p-4 -> p-2.5 */}
            <div className="bg-gradient-to-r from-purple-100/40 to-sky-100/40 rounded-xl p-2.5 border border-white/60 flex gap-3 items-start shadow-sm">
                <div className="w-6 h-6 rounded-full bg-white flex-shrink-0 flex items-center justify-center mt-0.5 shadow-sm">
                    <span className="text-[12px]">ğŸ¤–</span>
                </div>
                <p className="text-xs text-slate-600 leading-relaxed font-medium">
                    {feedback}
                </p>
            </div>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<GoalWidget />);
    </script>
</body>
</html>

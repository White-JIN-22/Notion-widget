<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fortress Flow To-Do</title>
    
    <script src="https://unpkg.com/react@18/umd/react.development.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js" crossorigin></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>

    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700&family=Playfair+Display:ital,wght@0,400;0,600;1,400&family=Roboto+Mono:wght@400;500&display=swap');

        body {
            font-family: 'Noto Sans KR', -apple-system, sans-serif;
            background-color: transparent;
            margin: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            overflow: hidden;
        }

        /* üßä Fortress Glass Container [cite: 2, 3, 4, 5] */
        .widget-container {
            position: relative;
            width: 280px; 
            height: 540px;
            background: linear-gradient(180deg, rgba(224, 242, 254, 0.2) 0%, rgba(240, 249, 255, 0.1) 100%);
            backdrop-filter: blur(20px);
            border-radius: 28px;
            border: 1px solid rgba(224, 242, 254, 0.3);
            box-shadow: 0 0 40px rgba(186, 230, 253, 0.1), inset 0 0 20px rgba(224, 242, 254, 0.1);
            display: flex;
            flex-direction: column;
            overflow: hidden;
            color: #e0f2fe;
        }

        .font-serif { font-family: 'Playfair Display', serif; }
        .no-scrollbar::-webkit-scrollbar { display: none; }
        
        .glass-panel {
            background: rgba(224, 242, 254, 0.1);
            border: 1px solid rgba(224, 242, 254, 0.2);
            border-radius: 16px;
            transition: all 0.3s ease;
        }

        .glass-input {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: #fff;
            backdrop-filter: blur(4px);
        }
        .glass-input::placeholder { color: rgba(224, 242, 254, 0.5); }

        /* Custom Checkbox */
        .custom-checkbox {
            appearance: none;
            width: 18px; height: 18px;
            border: 2px solid rgba(186, 230, 253, 0.5);
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s;
            position: relative;
        }
        .custom-checkbox:checked {
            background-color: #bae6fd;
            border-color: #bae6fd;
        }
        .custom-checkbox:checked::after {
            content: '‚úì';
            position: absolute;
            top: 50%; left: 50%;
            transform: translate(-50%, -50%);
            font-size: 12px; color: #fff; font-weight: bold;
        }

        .tab-btn {
            transition: all 0.2s;
            font-size: 12px;
            font-weight: 500;
            color: #94a3b8;
            padding: 6px 10px;
            border-radius: 12px;
        }
        .tab-active {
            background: rgba(255, 255, 255, 0.15);
            color: #7dd3fc;
            border: 1px solid rgba(125, 211, 252, 0.3);
            box-shadow: 0 2px 10px rgba(125, 211, 252, 0.1);
        }

        .priority-dot {
            width: 6px; height: 6px; border-radius: 50%;
        }
        
        /* Animations */
        @keyframes slideIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .task-item { animation: slideIn 0.3s ease-out forwards; }
        
        .delete-btn {
            opacity: 0; transition: opacity 0.2s;
        }
        .task-item:hover .delete-btn { opacity: 1; }

        /* Colors [cite: 7, 8, 9] */
        .text-sky { color: #bae6fd; }
        .text-purple { color: #d8b4fe; }
        .text-dim { color: #94a3b8; }
        .text-bright { color: #ffffff; text-shadow: 0 0 10px rgba(186, 230, 253, 0.3); }

    </style>
</head>
<body>

    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        const Icons = {
            Plus: () => <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2.5" strokeLinecap="round" strokeLinejoin="round"><line x1="12" y1="5" x2="12" y2="19"></line><line x1="5" y1="12" x2="19" y2="12"></line></svg>,
            Trash: () => <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polyline points="3 6 5 6 21 6"></polyline><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path></svg>,
            Sun: ({className}) => <svg className={className} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><circle cx="12" cy="12" r="5"></circle><line x1="12" y1="1" x2="12" y2="3"></line><line x1="12" y1="21" x2="12" y2="23"></line><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line><line x1="1" y1="12" x2="3" y2="12"></line><line x1="21" y1="12" x2="23" y2="12"></line><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line></svg>,
            Moon: ({className}) => <svg className={className} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path></svg>,
            Coffee: ({className}) => <svg className={className} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M18 8h1a4 4 0 0 1 0 8h-1"></path><path d="M2 8h16v9a4 4 0 0 1-4 4H6a4 4 0 0 1-4-4V8z"></path><line x1="6" y1="1" x2="6" y2="4"></line><line x1="10" y1="1" x2="10" y2="4"></line><line x1="14" y1="1" x2="14" y2="4"></line></svg>,
            Star: ({className}) => <svg className={className} viewBox="0 0 24 24" fill="currentColor" stroke="none"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"></polygon></svg>,
        };

        const App = () => {
            // [State] Îç∞Ïù¥ÌÑ∞ Î∞è ÏÉÅÌÉú Í¥ÄÎ¶¨
            const [tasks, setTasks] = useState([]);
            const [input, setInput] = useState("");
            const [timeSlot, setTimeSlot] = useState("Morning"); // Morning, Afternoon, Night
            const [priority, setPriority] = useState("normal"); // high(purple), normal(sky), low(slate)
            
            // Ï¥àÍ∏∞ Î°úÎìú
            useEffect(() => {
                const saved = JSON.parse(localStorage.getItem('fortressTodo') || '[]');
                setTasks(saved);
                
                // ÏãúÍ∞ÑÎåÄÏóê ÎßûÏ∂∞ ÏûêÎèô ÌÉ≠ ÏÑ§Ï†ï
                const h = new Date().getHours();
                if (h >= 5 && h < 12) setTimeSlot("Morning");
                else if (h >= 12 && h < 18) setTimeSlot("Afternoon");
                else setTimeSlot("Night");
            }, []);

            // Ï†ÄÏû•
            const saveTasks = (newTasks) => {
                setTasks(newTasks);
                localStorage.setItem('fortressTodo', JSON.stringify(newTasks));
            };

            const addTask = () => {
                if (!input.trim()) return;
                const newTask = {
                    id: Date.now(),
                    text: input,
                    completed: false,
                    slot: timeSlot,
                    priority: priority
                };
                saveTasks([...tasks, newTask]);
                setInput("");
            };

            const toggleComplete = (id) => {
                const newTasks = tasks.map(t => t.id === id ? {...t, completed: !t.completed} : t);
                saveTasks(newTasks);
            };

            const deleteTask = (id) => {
                const newTasks = tasks.filter(t => t.id !== id);
                saveTasks(newTasks);
            };

            const handleKeyDown = (e) => {
                if (e.key === 'Enter') addTask();
            };

            // ÌïÑÌÑ∞ÎßÅÎêú Î¶¨Ïä§Ìä∏
            const filteredTasks = tasks.filter(t => t.slot === timeSlot);
            const completedCount = tasks.filter(t => t.completed).length;

            // Ïπ≠Ï∞¨ Î©îÏãúÏßÄ Î°úÏßÅ (Î∂ÄÎã¥Ïä§ÎüΩÏßÄ ÏïäÍ≤å)
            const getPraiseMessage = () => {
                if (completedCount === 0) return "ÏûëÏùÄ ÏãúÏûëÏù¥ Ï§ëÏöîÌï¥Ïöî ‚òÅÔ∏è";
                if (completedCount <= 2) return "Í∏∞Î∂Ñ Ï¢ãÏùÄ ÌùêÎ¶ÑÏù¥ÎÑ§Ïöî! üíß";
                if (completedCount <= 5) return "Ïò§Îäò Ï†ïÎßê ÏûòÌïòÍ≥† ÏûàÏñ¥Ïöî ‚ú®";
                return "ÏôÑÎ≤ΩÌïú ÌïòÎ£®ÏòàÏöî üè∞";
            };

            const getSlotIcon = (slot) => {
                if (slot === 'Morning') return <Icons.Sun className="w-3 h-3 text-sky-300"/>;
                if (slot === 'Afternoon') return <Icons.Coffee className="w-3 h-3 text-purple-300"/>;
                return <Icons.Moon className="w-3 h-3 text-slate-400"/>;
            };

            return (
                <div className="widget-container p-5">
                    {/* 1. Header Area */}
                    <div className="mb-4 flex justify-between items-end">
                        <div>
                            <h1 className="text-xl font-bold text-bright font-serif italic tracking-wide">
                                ‡ºö‚úß Flow To-Do ‚úß‡ºö
                            </h1>
                            <p className="text-[10px] text-dim mt-1 pl-0.5">Manage energy, not just time.</p>
                        </div>
                        <div className="text-right">
                            <div className="text-2xl font-bold text-sky font-serif italic">{completedCount}</div>
                            <div className="text-[9px] text-dim uppercase tracking-wider">Done</div>
                        </div>
                    </div>

                    {/* 2. Input Area */}
                    <div className="glass-panel p-2 mb-4 flex gap-2 items-center">
                        <input 
                            type="text" 
                            value={input}
                            onChange={(e) => setInput(e.target.value)}
                            onKeyDown={handleKeyDown}
                            placeholder="Ìï† ÏùºÏùÑ ÏûÖÎ†•ÌïòÏÑ∏Ïöî..."
                            className="bg-transparent border-none outline-none text-sm text-white placeholder-slate-400 flex-1 px-2 font-medium"
                        />
                        
                        {/* Priority Toggle */}
                        <button 
                            onClick={() => setPriority(p => p === 'normal' ? 'high' : p === 'high' ? 'low' : 'normal')}
                            className={`w-6 h-6 rounded-full flex items-center justify-center transition-all border ${
                                priority === 'high' ? 'bg-purple-500/20 border-purple-300 text-purple-300' : 
                                priority === 'normal' ? 'bg-sky-500/20 border-sky-300 text-sky-300' : 
                                'bg-slate-500/20 border-slate-400 text-slate-400'
                            }`}
                            title="Ïö∞ÏÑ†ÏàúÏúÑ Î≥ÄÍ≤Ω"
                        >
                            <div className="w-2 h-2 rounded-full bg-current"></div>
                        </button>

                        <button 
                            onClick={addTask}
                            className="w-7 h-7 rounded-lg bg-white/10 hover:bg-white/20 flex items-center justify-center text-white transition-all"
                        >
                            <Icons.Plus />
                        </button>
                    </div>

                    {/* 3. Time Slot Tabs */}
                    <div className="flex gap-1 mb-3 bg-black/10 p-1 rounded-2xl">
                        {['Morning', 'Afternoon', 'Night'].map((slot) => (
                            <button 
                                key={slot} 
                                onClick={() => setTimeSlot(slot)}
                                className={`flex-1 flex items-center justify-center gap-1.5 tab-btn ${timeSlot === slot ? 'tab-active' : 'hover:text-white'}`}
                            >
                                {getSlotIcon(slot)}
                                <span>{slot === 'Morning' ? 'AM' : slot === 'Afternoon' ? 'PM' : 'Night'}</span>
                            </button>
                        ))}
                    </div>

                    {/* 4. Task List */}
                    <div className="flex-1 overflow-y-auto no-scrollbar space-y-2 relative pb-2">
                        {filteredTasks.length === 0 ? (
                            <div className="h-full flex flex-col items-center justify-center opacity-40 text-center">
                                <span className="text-2xl mb-2 filter grayscale opacity-50">
                                    {timeSlot === 'Morning' ? 'üåÖ' : timeSlot === 'Afternoon' ? '‚òï' : 'üåô'}
                                </span>
                                <p className="text-xs text-dim">
                                    {timeSlot === 'Morning' ? 'Í∞ÄÎ≤ºÏö¥ ÏãúÏûëÏùÑ Ï§ÄÎπÑÌï¥Ïöî' : 
                                     timeSlot === 'Afternoon' ? 'Î™∞ÏûÖÌï† ÏãúÍ∞ÑÏûÖÎãàÎã§' : 
                                     'ÎÇ¥ÏùºÏùÑ ÏúÑÌï¥ Ï†ïÎ¶¨Ìï¥Ïöî'}
                                </p>
                            </div>
                        ) : (
                            filteredTasks.map(task => (
                                <div key={task.id} className={`task-item glass-panel p-3 flex items-center gap-3 group ${task.completed ? 'opacity-50' : ''}`}>
                                    <input 
                                        type="checkbox" 
                                        checked={task.completed} 
                                        onChange={() => toggleComplete(task.id)}
                                        className="custom-checkbox shrink-0"
                                    />
                                    
                                    <div className="flex-1 min-w-0">
                                        <p className={`text-sm font-medium truncate transition-all ${task.completed ? 'text-dim line-through decoration-slate-500' : 'text-bright'}`}>
                                            {task.text}
                                        </p>
                                    </div>

                                    {/* Priority Indicator */}
                                    {!task.completed && (
                                        <div className={`w-1.5 h-1.5 rounded-full shrink-0 ${
                                            task.priority === 'high' ? 'bg-purple-300 shadow-[0_0_5px_#d8b4fe]' : 
                                            task.priority === 'normal' ? 'bg-sky-300' : 'bg-slate-500'
                                        }`}></div>
                                    )}

                                    <button 
                                        onClick={() => deleteTask(task.id)}
                                        className="delete-btn text-dim hover:text-red-300 p-1"
                                    >
                                        <Icons.Trash />
                                    </button>
                                </div>
                            ))
                        )}
                    </div>

                    {/* 5. Footer Praise */}
                    <div className="mt-2 pt-3 border-t border-white/10 text-center">
                        <p className="text-xs font-serif italic text-sky-300/80 animate-pulse">
                            "{getPraiseMessage()}"
                        </p>
                    </div>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>

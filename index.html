<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Jinsol Focus Widget (Dark Mode)</title>
    
    <meta name="robots" content="noindex, nofollow">
    <meta name="googlebot" content="noindex, nofollow">
    <meta name="bingbot" content="noindex, nofollow">

    <script src="https://unpkg.com/react@18/umd/react.development.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js" crossorigin></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/framer-motion@10.16.4/dist/framer-motion.js"></script>
    <script src="https://unpkg.com/lucide@latest"></script>

    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            background-color: #191919; /* ë…¸ì…˜ ë‹¤í¬ëª¨ë“œ ë°°ê²½ìƒ‰ */
            color: #ffffff;
        }
        /* ì›í˜• íƒ€ì´ë¨¸ ìŠ¤íƒ€ì¼ */
        .timer-circle {
            transition: stroke-dashoffset 1s linear;
        }
    </style>
</head>
<body class="flex items-center justify-center min-h-screen">

    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;
        const { motion, AnimatePresence } = FramerMotion;

        // ì•„ì´ì½˜ ì»´í¬ë„ŒíŠ¸
        const IconZap = () => <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"></polygon></svg>;
        const IconArrowUp = () => <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><line x1="12" y1="19" x2="12" y2="5"></line><polyline points="5 12 12 5 19 12"></polyline></svg>;
        const IconCoffee = () => <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M18 8h1a4 4 0 0 1 0 8h-1"></path><path d="M2 8h16v9a4 4 0 0 1-4 4H6a4 4 0 0 1-4 4V8z"></path><line x1="6" y1="1" x2="6" y2="4"></line><line x1="10" y1="1" x2="10" y2="4"></line><line x1="14" y1="1" x2="14" y2="4"></line></svg>;
        const IconCheck = () => <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polyline points="20 6 9 17 4 12"></polyline></svg>;
        const IconRefresh = () => <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polyline points="23 4 23 10 17 10"></polyline><polyline points="1 20 1 14 7 14"></polyline><path d="M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"></path></svg>;

        // ì„¤ì •ê°’ (í…ŒìŠ¤íŠ¸ìš© 30ì´ˆ) ë° íŒŒìŠ¤í…” ê·¸ë¼ë°ì´ì…˜ ì ìš©
        const PHASES = {
            START: {
                id: 'start',
                duration: 30, 
                // íŒŒìŠ¤í…” ë¸”ë£¨ -> ë¼ë²¤ë” ê·¸ë¼ë°ì´ì…˜
                color: 'bg-gradient-to-br from-[#BCECEC] to-[#C2BBFF]', 
                textColor: 'text-slate-800',
                title: '30-second ignition',
                subtext: 'Start while standing',
                icon: <IconZap />
            },
            EXTENSION: {
                id: 'extension',
                duration: 30, 
                // íŒŒìŠ¤í…” í•‘í¬ -> ì˜¤ë Œì§€ ê·¸ë¼ë°ì´ì…˜
                color: 'bg-gradient-to-br from-[#FFD1FF] to-[#FBD0C8]', 
                textColor: 'text-slate-800',
                title: 'Extend focus?',
                subtext: 'Optional step',
                icon: <IconArrowUp />
            },
            TRANSITION: {
                id: 'transition',
                duration: 30, 
                // íŒŒìŠ¤í…” ë¯¼íŠ¸ -> ì˜ë¡œìš° ê·¸ë¼ë°ì´ì…˜
                color: 'bg-gradient-to-br from-[#F7CDE1] to-[#97F7F5]', 
                textColor: 'text-slate-800',
                title: 'Transition Routine',
                subtext: 'Mandatory Rest',
                icon: <IconCoffee />
            }
        };

        // ì˜¤ë””ì˜¤ íŒŒì¼ ê²½ë¡œ (ì‹¤ì œ íŒŒì¼ì´ í•„ìš”í•©ë‹ˆë‹¤. ì˜ˆì‹œ ê²½ë¡œì…ë‹ˆë‹¤.)
        const clickSound = new Audio('https://assets.mixkit.co/active_storage/sfx/2568/2568-preview.mp3'); // ë¬¼ë°©ìš¸ ì†Œë¦¬ ì˜ˆì‹œ
        const fanfareSound = new Audio('https://assets.mixkit.co/active_storage/sfx/1003/1003-preview.mp3'); // ì§§ì€ íŒ¡íŒŒë ˆ ì˜ˆì‹œ
        clickSound.volume = 0.5;
        fanfareSound.volume = 0.4;

        const FocusWidget = () => {
            const [currentPhase, setCurrentPhase] = useState('start');
            const [timeLeft, setTimeLeft] = useState(PHASES.START.duration);
            const [isActive, setIsActive] = useState(false);
            const [showExtensionChoice, setShowExtensionChoice] = useState(false);
            const [isFinished, setIsFinished] = useState(false);

            const playClickSound = () => {
                clickSound.currentTime = 0;
                clickSound.play().catch(e => console.log("Audio play failed:", e));
            };

            const playFanfareSound = () => {
                fanfareSound.currentTime = 0;
                fanfareSound.play().catch(e => console.log("Audio play failed:", e));
            };

            useEffect(() => {
                let interval = null;
                if (isActive && timeLeft > 0) {
                    interval = setInterval(() => {
                        setTimeLeft((time) => time - 1);
                    }, 1000);
                } else if (timeLeft === 0 && isActive) {
                    setIsActive(false);
                    playFanfareSound(); // íƒ€ì´ë¨¸ ì¢…ë£Œ ì‹œ íŒ¡íŒŒë ˆ
                    handlePhaseComplete();
                }
                return () => clearInterval(interval);
            }, [isActive, timeLeft]);

            const handlePhaseComplete = () => {
                if (currentPhase === 'start') {
                    setShowExtensionChoice(true);
                } else if (currentPhase === 'extension') {
                    startTransition();
                } else if (currentPhase === 'transition') {
                    setIsFinished(true);
                }
            };

            const startTransition = () => {
                setCurrentPhase('transition');
                setTimeLeft(PHASES.TRANSITION.duration);
                setIsActive(true);
                setShowExtensionChoice(false);
            };

            const startExtension = () => {
                setCurrentPhase('extension');
                setTimeLeft(PHASES.EXTENSION.duration);
                setIsActive(true);
                setShowExtensionChoice(false);
            };

            const resetAll = () => {
                setCurrentPhase('start');
                setTimeLeft(PHASES.START.duration);
                setIsActive(false);
                setIsFinished(false);
                setShowExtensionChoice(false);
            };

            const formatTime = (seconds) => {
                const m = Math.floor(seconds / 60).toString().padStart(2, '0');
                const s = (seconds % 60).toString().padStart(2, '0');
                return `${m}:${s}`;
            };

            const currentData = PHASES[currentPhase.toUpperCase()];
            
            // ì›í˜• íƒ€ì´ë¨¸ ê³„ì‚°
            const radius = 36;
            const circumference = 2 * Math.PI * radius;
            const progress = timeLeft / currentData.duration;
            const dashoffset = circumference * (1 - progress);

            return (
                // ì „ì²´ ì»¨í…Œì´ë„ˆ: ë…¸ì…˜ ë‹¤í¬ëª¨ë“œ ë°°ê²½ ë° ì¤‘ì•™ ì •ë ¬
                <div className="relative w-96 h-[450px] flex items-center justify-center bg-[#191919] p-8 rounded-[40px] shadow-2xl overflow-hidden">
                    
                    <AnimatePresence mode='wait'>
                        {!isFinished ? (
                            <motion.div
                                key={currentPhase}
                                // ì¹´ë“œ ìŠ¬ë¼ì´ë“œ ì• ë‹ˆë©”ì´ì…˜: ì•„ë˜ì—ì„œ ìœ„ë¡œ ë¶€ë“œëŸ½ê²Œ
                                initial={{ y: 40, opacity: 0, scale: 0.95 }}
                                animate={{ y: 0, opacity: 1, scale: 1 }}
                                exit={{ y: -40, opacity: 0, scale: 0.95 }}
                                transition={{ type: "spring", stiffness: 150, damping: 20 }}
                                className="relative w-full h-full"
                            >
                                {/* ë’·ë©´ ì¹´ë“œ (ìŠ¤íƒ íš¨ê³¼) - ìœ„ì¹˜ ë° í¬ê¸° ë¯¸ì„¸ ì¡°ì • */}
                                <div className={`absolute top-0 left-0 w-full h-full rounded-3xl transform translate-y-3 scale-[0.92] opacity-50 -z-10 ${currentPhase === 'start' ? PHASES.EXTENSION.color : PHASES.TRANSITION.color}`}></div>
                                <div className={`absolute top-0 left-0 w-full h-full rounded-3xl transform translate-y-6 scale-[0.85] opacity-30 -z-20 bg-slate-700`}></div>
                                
                                {/* ë©”ì¸ í™œì„± ì¹´ë“œ */}
                                <div className={`relative z-10 w-full h-full p-6 rounded-3xl shadow-lg flex flex-col justify-between ${currentData.color} ${currentData.textColor}`}>
                                    {/* í—¤ë” */}
                                    <div className="flex items-center justify-between opacity-80">
                                        <span className="text-sm font-semibold tracking-wide uppercase">
                                            {currentPhase === 'start' ? 'Step 1' : currentPhase === 'extension' ? 'Step 2' : 'Step 3'}
                                        </span>
                                        {currentData.icon}
                                    </div>

                                    {/* í¬ëª¨ë„ë¡œ ìŠ¤íƒ€ì¼ íƒ€ì´ë¨¸ (ê°€ë¡œ ë°°ì¹˜) */}
                                    <div className="flex items-center justify-center gap-6 py-4">
                                        {/* ì›í˜• ì§„í–‰ë¥  ë°” */}
                                        <div className="relative w-24 h-24">
                                            <svg className="w-full h-full" viewBox="0 0 100 100">
                                                {/* ë°°ê²½ ì› (ì—°í•œ ìƒ‰) */}
                                                <circle
                                                    className="text-white opacity-30"
                                                    strokeWidth="8"
                                                    stroke="currentColor"
                                                    fill="transparent"
                                                    r={radius}
                                                    cx="50"
                                                    cy="50"
                                                />
                                                {/* ì§„í–‰ ì› (ì§„í•œ íŒŒë€ìƒ‰/í•˜ëŠ˜ìƒ‰ ê³„ì—´) */}
                                                <circle
                                                    className="text-blue-600 timer-circle"
                                                    strokeWidth="8"
                                                    strokeDasharray={circumference}
                                                    strokeDashoffset={dashoffset}
                                                    strokeLinecap="round"
                                                    stroke="currentColor"
                                                    fill="transparent"
                                                    r={radius}
                                                    cx="50"
                                                    cy="50"
                                                    transform="rotate(-90 50 50)"
                                                />
                                            </svg>
                                        </div>
                                        {/* ìƒì„¸ ì‹œê°„ í…ìŠ¤íŠ¸ */}
                                        <div className="flex flex-col">
                                            <h1 className="text-5xl font-bold tracking-tight leading-none">
                                                {formatTime(timeLeft)}
                                            </h1>
                                            <h2 className="text-lg font-medium opacity-90 mt-1">
                                                {currentData.title}
                                            </h2>
                                        </div>
                                    </div>

                                    {/* ë²„íŠ¼ ì˜ì—­ (ëª¨ë…¸í†¤/ë„¤ì´ë¹„ ìŠ¤íƒ€ì¼ ì ìš©) */}
                                    <div className="mt-2">
                                        {!showExtensionChoice && (
                                            currentPhase === 'transition' ? (
                                                // íœ´ì‹ ë‹¨ê³„ ì²´í¬ë¦¬ìŠ¤íŠ¸ ìŠ¤íƒ€ì¼ ë³€ê²½
                                                <div className="space-y-2 text-sm font-medium">
                                                    <div className="flex items-center gap-2 opacity-80"><span className="text-blue-700">ğŸ’§</span> Drink water</div>
                                                    <div className="flex items-center gap-2 opacity-80"><span className="text-blue-700">ğŸš¶</span> Move spots</div>
                                                    <div className="flex items-center gap-2 opacity-80"><span className="text-blue-700">ğŸ§˜</span> Stretch</div>
                                                    <button onClick={() => { playClickSound(); setIsFinished(true); }} className="w-full mt-3 bg-slate-800/20 hover:bg-slate-800/40 py-2.5 rounded-xl transition-colors font-semibold">
                                                        Done Early
                                                    </button>
                                                </div>
                                            ) : (
                                                // ë©”ì¸ ë²„íŠ¼ (ë„¤ì´ë¹„ ë°°ê²½ + í•˜ëŠ˜ìƒ‰ í…ìŠ¤íŠ¸)
                                                <button
                                                    onClick={() => { playClickSound(); setIsActive(!isActive); }}
                                                    className="w-full py-3.5 bg-slate-900 hover:bg-slate-800 text-sky-300 rounded-2xl text-lg font-bold transition-all shadow-md active:scale-95"
                                                >
                                                    {isActive ? "Pause" : "Start Focus"}
                                                </button>
                                            )
                                        )}

                                        {showExtensionChoice && (
                                            <div className="flex flex-col gap-2.5">
                                                {/* ì—°ì¥ ë²„íŠ¼ (ê°•ì¡°) */}
                                                <button
                                                    onClick={() => { playClickSound(); startExtension(); }}
                                                    className="w-full py-3.5 bg-blue-600 hover:bg-blue-500 text-white rounded-xl font-bold transition-colors flex items-center justify-center gap-2 shadow-md active:scale-95"
                                                >
                                                    <IconArrowUp /> Extend +30 sec
                                                </button>
                                                {/* íœ´ì‹ ë²„íŠ¼ (ë³´ì¡°) */}
                                                <button
                                                    onClick={() => { playClickSound(); startTransition(); }}
                                                    className="w-full py-3.5 bg-slate-800/30 hover:bg-slate-800/50 text-slate-800 rounded-xl font-semibold transition-colors text-sm active:scale-95"
                                                >
                                                    No, Start Transition (Rest)
                                                </button>
                                            </div>
                                        )}
                                    </div>
                                </div>
                            </motion.div>
                        ) : (
                            /* ì™„ë£Œ í™”ë©´ (ë‹¤í¬ëª¨ë“œ ìŠ¤íƒ€ì¼) */
                            <motion.div
                                initial={{ scale: 0.9, opacity: 0 }}
                                animate={{ scale: 1, opacity: 1 }}
                                className="relative z-10 w-full h-full bg-slate-800 p-6 rounded-3xl shadow-xl flex flex-col items-center justify-center text-center text-white"
                            >
                                <div className="w-20 h-20 bg-slate-700 rounded-full flex items-center justify-center mb-5 text-sky-400">
                                    <IconCheck />
                                </div>
                                <h2 className="text-2xl font-bold mb-2">Session Complete</h2>
                                <p className="text-slate-300 text-sm mb-8">You are refreshed and ready.</p>
                                <button
                                    onClick={() => { playClickSound(); resetAll(); }}
                                    className="flex items-center gap-2 px-8 py-3.5 bg-sky-500 hover:bg-sky-400 text-white rounded-full font-bold transition-all shadow-lg active:scale-95"
                                >
                                    <IconRefresh /> Reset Widget
                                </button>
                            </motion.div>
                        )}
                    </AnimatePresence>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<FocusWidget />);
    </script>
</body>
</html>

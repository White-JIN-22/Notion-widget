<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Jinsol Pastel Gradient Widget</title>
    
    <meta name="robots" content="noindex, nofollow">
    <meta name="googlebot" content="noindex, nofollow">
    <meta name="bingbot" content="noindex, nofollow">

    <script src="https://unpkg.com/react@18/umd/react.development.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js" crossorigin></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>

    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            background-color: #191919; /* ë…¸ì…˜ ë‹¤í¬ëª¨ë“œ ë°°ê²½ */
            margin: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            color: white;
            overflow: hidden;
        }

        .tabular-nums { font-variant-numeric: tabular-nums; }
        .timer-circle { transition: stroke-dashoffset 1s linear; }

        /* ì¹´ë“œ ì»¨í…Œì´ë„ˆ */
        .card-container {
            position: relative;
            width: 380px;
            height: 240px;
        }

        .card {
            position: absolute;
            top: 0;
            left: 0;
            width: 340px;
            height: 200px;
            border-radius: 28px;
            transition: transform 0.8s cubic-bezier(0.2, 0.8, 0.2, 1), opacity 0.6s ease, filter 0.6s ease;
            /* ìœ ë¦¬ ì§ˆê° í…Œë‘ë¦¬ */
            box-shadow: 0 10px 40px -10px rgba(0,0,0,0.1), inset 0 0 0 1px rgba(255,255,255,0.3);
            display: flex;
            flex-direction: row;
            align-items: center;
            justify-content: space-between;
            padding: 24px;
            box-sizing: border-box;
            transform-origin: center center;
            backdrop-filter: blur(12px);
        }

        /* í™œì„± ì¹´ë“œ */
        .card.active {
            z-index: 30;
            transform: translate(0, 0) scale(1);
            opacity: 1;
            filter: blur(0px);
        }

        /* ëŒ€ê¸° ì¹´ë“œ 1 */
        .card.next-1 {
            z-index: 20;
            transform: translate(14px, 14px) scale(0.96);
            opacity: 0.4;
            filter: blur(2px);
        }

        /* ëŒ€ê¸° ì¹´ë“œ 2 */
        .card.next-2 {
            z-index: 10;
            transform: translate(28px, 28px) scale(0.92);
            opacity: 0.2;
            filter: blur(4px);
        }

        /* ì¹´ë“œ í‡´ì¥ ì• ë‹ˆë©”ì´ì…˜ */
        .card.exit {
            z-index: 40;
            transform: translate(-40px, -10px) scale(0.98); 
            opacity: 0; 
            filter: blur(12px); 
            pointer-events: none;
        }

        /* âœ¨ ì™„ë£Œ ì¹´ë“œ ì „ìš© ìŠ¤íƒ€ì¼ */
        .card.success-card {
            border: 3px solid rgba(255, 255, 255, 0.7);
            box-shadow: 0 20px 60px -15px rgba(251, 191, 36, 0.4), inset 0 0 20px rgba(255,255,255,0.3);
        }
    </style>
</head>
<body>

    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // ì•„ì´ì½˜
        const IconZap = () => <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="3" strokeLinecap="round" strokeLinejoin="round"><polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"></polygon></svg>;
        // âœ¨ ìƒˆë¡œìš´ ìŠ¤íŒŒí¬ ì•„ì´ì½˜ (ê¸°ì¡´ ë¶ˆê½ƒ ëŒ€ì²´)
        const IconSparkles = () => <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor" stroke="none"><path d="M12 2.25a.75.75 0 01.75.75v2.25a.75.75 0 01-1.5 0V3a.75.75 0 01.75-.75zM7.5 12a4.5 4.5 0 119 0 4.5 4.5 0 01-9 0zM18.75 10.5a.75.75 0 01.75-.75h2.25a.75.75 0 010 1.5h-2.25a.75.75 0 01-.75-.75zM2.25 10.5a.75.75 0 01.75-.75h2.25a.75.75 0 010 1.5H3a.75.75 0 01-.75-.75zM10.5 18.75a.75.75 0 01.75.75v2.25a.75.75 0 01-1.5 0v-2.25a.75.75 0 01.75-.75zM10.5 2.25a.75.75 0 01.75.75v2.25a.75.75 0 01-1.5 0V3a.75.75 0 01.75-.75zM18.75 10.5a.75.75 0 01.75-.75h2.25a.75.75 0 010 1.5h-2.25a.75.75 0 01-.75-.75zM2.25 10.5a.75.75 0 01.75-.75h2.25a.75.75 0 010 1.5H3a.75.75 0 01-.75-.75zM10.5 18.75a.75.75 0 01.75.75v2.25a.75.75 0 01-1.5 0v-2.25a.75.75 0 01.75-.75z"/></svg>;
        const IconArrowUp = () => <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="3" strokeLinecap="round" strokeLinejoin="round"><line x1="12" y1="19" x2="12" y2="5"></line><polyline points="5 12 12 5 19 12"></polyline></svg>;
        const IconCoffee = () => <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="3" strokeLinecap="round" strokeLinejoin="round"><path d="M18 8h1a4 4 0 0 1 0 8h-1"></path><path d="M2 8h16v9a4 4 0 0 1-4 4H6a4 4 0 0 1-4 4V8z"></path><line x1="6" y1="1" x2="6" y2="4"></line><line x1="10" y1="1" x2="10" y2="4"></line><line x1="14" y1="1" x2="14" y2="4"></line></svg>;
        const IconCheck = () => <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="4" strokeLinecap="round" strokeLinejoin="round"><polyline points="20 6 9 17 4 12"></polyline></svg>;
        const IconRefresh = () => <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="3" strokeLinecap="round" strokeLinejoin="round"><polyline points="23 4 23 10 17 10"></polyline><polyline points="1 20 1 14 7 14"></polyline><path d="M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"></path></svg>;

        const PHASES = {
            START: {
                id: 'start',
                duration: 10, 
                // ğŸ¨ 1ë‹¨ê³„: ë” ë¶€ë“œëŸ¬ìš´ íŒŒìŠ¤í…” ë„¤ì´ë¹„/ë¸”ë£¨ ê·¸ë¼ë°ì´ì…˜
                bgClass: 'bg-gradient-to-br from-[#4b6cb7] to-[#182848]', 
                textClass: 'text-white',
                // âœ¨ ë²„íŠ¼ ìƒ‰ìƒ: í…Œë§ˆì— ë§ì¶˜ ë”¥ ë¸”ë£¨
                accentClass: 'bg-[#1e3a8a] text-white hover:bg-[#172554]', 
                title: 'Focus',
                icon: <IconZap />
            },
            EXTENSION: {
                id: 'extension',
                duration: 10, 
                // ğŸ¨ 2ë‹¨ê³„: ë” í™”ì‚¬í•œ íŒŒìŠ¤í…” ìŠ¤ì¹´ì´ë¸”ë£¨/ì‹œì•ˆ ê·¸ë¼ë°ì´ì…˜
                bgClass: 'bg-gradient-to-br from-[#00c6ff] to-[#0072ff]', 
                textClass: 'text-white',
                // âœ¨ ë²„íŠ¼ ìƒ‰ìƒ: í…Œë§ˆì— ë§ì¶˜ ë”¥ ìŠ¤ì¹´ì´ë¸”ë£¨
                accentClass: 'bg-[#0284c7] text-white hover:bg-[#0369a1]', 
                title: 'Extend!',
                icon: <IconArrowUp />
            },
            TRANSITION: {
                id: 'transition',
                duration: 10, 
                // ğŸ¨ 3ë‹¨ê³„: ì€ì€í•œ íŒŒìŠ¤í…” í™”ì´íŠ¸/ê·¸ë ˆì´ ê·¸ë¼ë°ì´ì…˜
                bgClass: 'bg-gradient-to-br from-[#e6e9f0] to-[#eef1f5]', 
                textClass: 'text-[#1e3a8a]',
                // âœ¨ ë²„íŠ¼ ìƒ‰ìƒ: í…Œë§ˆì— ë§ì¶˜ ë”¥ ê·¸ë ˆì´/ë„¤ì´ë¹„
                accentClass: 'bg-[#334155] text-white hover:bg-[#1e293b]', 
                title: 'Rest',
                icon: <IconCoffee />
            }
        };

        const PHASE_ORDER = ['start', 'extension', 'transition'];

        const playSound = (type) => {
            try {
                const src = type === 'click' 
                    ? 'https://assets.mixkit.co/active_storage/sfx/2568/2568-preview.mp3' 
                    : 'https://assets.mixkit.co/active_storage/sfx/2044/2044-preview.mp3'; 
                const audio = new Audio(src);
                audio.volume = type === 'click' ? 0.3 : 0.6; 
                audio.play().catch(() => {});
            } catch (e) {}
        };

        const FocusWidget = () => {
            const [currentPhase, setCurrentPhase] = useState('start');
            const [timeLeft, setTimeLeft] = useState(PHASES.START.duration);
            const [isActive, setIsActive] = useState(false);
            const [showExtensionChoice, setShowExtensionChoice] = useState(false);
            const [showTransitionButton, setShowTransitionButton] = useState(false);
            const [isFinished, setIsFinished] = useState(false);
            const [exitingPhase, setExitingPhase] = useState(null);
            const [sparkCount, setSparkCount] = useState(0);

            useEffect(() => {
                const savedDate = localStorage.getItem('sparkDate');
                const today = new Date().toDateString();
                const savedCount = parseInt(localStorage.getItem('sparkCount') || '0');

                if (savedDate !== today) {
                    setSparkCount(0);
                    localStorage.setItem('sparkDate', today);
                    localStorage.setItem('sparkCount', '0');
                } else {
                    setSparkCount(savedCount);
                }
            }, []);

            const incrementSpark = () => {
                const newCount = sparkCount + 1;
                setSparkCount(newCount);
                localStorage.setItem('sparkCount', newCount.toString());
                localStorage.setItem('sparkDate', new Date().toDateString());
            };

            useEffect(() => {
                let interval = null;
                if (isActive && timeLeft > 0) {
                    interval = setInterval(() => {
                        setTimeLeft((t) => t - 1);
                    }, 1000);
                } else if (timeLeft === 0 && isActive) {
                    setIsActive(false);
                    playSound('finish');
                    handlePhaseComplete();
                }
                return () => clearInterval(interval);
            }, [isActive, timeLeft]);

            const handlePhaseComplete = () => {
                if (currentPhase === 'start') {
                    incrementSpark();
                    setShowExtensionChoice(true);
                } else if (currentPhase === 'extension') {
                    setShowTransitionButton(true);
                } else if (currentPhase === 'transition') {
                    setIsFinished(true);
                }
            };

            const animateTransition = (nextPhaseKey) => {
                setExitingPhase(currentPhase);
                setTimeout(() => {
                    setCurrentPhase(nextPhaseKey);
                    setTimeLeft(PHASES[nextPhaseKey.toUpperCase()].duration);
                    setIsActive(true);
                    setShowExtensionChoice(false);
                    setShowTransitionButton(false);
                    setExitingPhase(null);
                    playSound('click');
                }, 600);
            };

            const resetAll = () => {
                setCurrentPhase('start');
                setTimeLeft(PHASES.START.duration);
                setIsActive(false);
                setIsFinished(false);
                setShowExtensionChoice(false);
                setShowTransitionButton(false);
                playSound('click');
            };

            const formatTime = (seconds) => {
                const m = Math.floor(seconds / 60).toString().padStart(2, '0');
                const s = (seconds % 60).toString().padStart(2, '0');
                return `${m}:${s}`;
            };

            const renderCard = (phaseKey) => {
                const data = PHASES[phaseKey.toUpperCase()];
                const currentIndex = PHASE_ORDER.indexOf(currentPhase);
                const phaseIndex = PHASE_ORDER.indexOf(phaseKey);

                let statusClass = '';
                if (exitingPhase === phaseKey) statusClass = 'exit'; 
                else if (currentPhase === phaseKey && !exitingPhase) statusClass = 'active'; 
                else if (phaseIndex > currentIndex) statusClass = `next-${phaseIndex - currentIndex}`;
                else return null;

                const radius = 36;
                const strokeWidth = 10;
                const circumference = 2 * Math.PI * radius;
                const maxDuration = data.duration;
                const progress = timeLeft / maxDuration;
                const dashoffset = circumference * (1 - progress);

                const iconColor = phaseKey === 'transition' ? 'text-[#1e3a8a]' : 'text-white';
                const timerColor = phaseKey === 'transition' ? 'text-[#1e3a8a]' : 'text-white';

                return (
                    <div key={phaseKey} className={`card ${data.bgClass} ${data.textClass} ${statusClass}`}>
                        {phaseKey === 'start' && (
                            <>
                                {/* âœ¨ ì í™” íšŸìˆ˜: ë°˜íˆ¬ëª… ë°•ìŠ¤ë¡œ ë””ìì¸ ë³€ê²½ ë° ìƒˆ ì•„ì´ì½˜ ì ìš© */}
                                <div className="absolute top-5 left-6 flex items-center gap-2 py-1.5 px-3 bg-white/20 rounded-lg backdrop-blur-md shadow-sm border border-white/30 transition-all hover:bg-white/30">
                                    <span className="text-white opacity-90"><IconSparkles /></span>
                                    <span className="text-base font-bold tabular-nums text-white">{sparkCount}</span>
                                </div>
                                <div className="absolute top-5 right-6 opacity-90 text-white">
                                    <IconZap />
                                </div>
                            </>
                        )}

                        <div className="relative w-24 h-24 flex-shrink-0 mr-5">
                            <svg className="w-full h-full transform -rotate-90" viewBox="0 0 100 100">
                                <circle className={`${timerColor} opacity-30`} strokeWidth={strokeWidth} stroke="currentColor" fill="transparent" r={radius} cx="50" cy="50" />
                                <circle className={`${timerColor} timer-circle drop-shadow-sm`} strokeWidth={strokeWidth} strokeDasharray={circumference} strokeDashoffset={dashoffset} strokeLinecap="round" stroke="currentColor" fill="transparent" r={radius} cx="50" cy="50" />
                            </svg>
                        </div>
                        <div className="flex-1 flex flex-col justify-center h-full mt-6">
                            <div className="flex justify-between items-center mb-1 opacity-90">
                                <span className="text-sm font-bold uppercase tracking-widest">{data.title}</span>
                                {phaseKey !== 'start' && (
                                    <div className={`p-2 rounded-full backdrop-blur-sm shadow-sm ${iconColor} bg-white/20`}>{data.icon}</div>
                                )}
                            </div>
                            <div className="text-5xl font-bold tracking-tight leading-none tabular-nums mb-5 drop-shadow-sm opacity-95">
                                {formatTime(timeLeft)}
                            </div>
                            <div className="w-full h-12"> 
                                {!showExtensionChoice && !showTransitionButton && (
                                    phaseKey === 'transition' ? (
                                        <div className="flex gap-2 h-full items-center">
                                            <div className="text-sm font-bold opacity-80 flex items-center gap-1">ğŸ’§ Water</div>
                                            <div className="text-sm font-bold opacity-80 flex items-center gap-1">ğŸ“– Read</div>
                                            <button onClick={() => setIsFinished(true)} className="ml-auto px-5 py-2.5 bg-black/5 hover:bg-black/10 rounded-xl text-sm font-bold transition-colors">Done</button>
                                        </div>
                                    ) : (
                                        <button onClick={() => { setIsActive(!isActive); playSound('click'); }} className={`w-full h-full rounded-2xl text-base font-bold shadow-md transition-all active:scale-95 flex items-center justify-center gap-2 ${data.accentClass}`}>
                                            {isActive ? "Pause" : "Start"}
                                        </button>
                                    )
                                )}
                                {showExtensionChoice && (
                                    <div className="flex gap-3 h-full">
                                        <button onClick={() => animateTransition('extension')} className={`flex-1 rounded-2xl text-base font-bold shadow-md transition-all active:scale-95 ${data.accentClass}`}>+5 min</button>
                                        <button onClick={() => animateTransition('transition')} className="px-6 bg-white/20 hover:bg-white/30 text-white rounded-2xl text-sm font-bold transition-colors shadow-sm backdrop-blur-md">Skip</button>
                                    </div>
                                )}
                                {showTransitionButton && phaseKey === 'extension' && (
                                    <button onClick={() => animateTransition('transition')} className="w-full h-full rounded-2xl text-base font-bold shadow-md transition-all active:scale-95 bg-white text-[#1e3a8a] hover:bg-blue-50 flex items-center justify-center gap-2">
                                        Start Rest â˜•ï¸
                                    </button>
                                )}
                            </div>
                        </div>
                    </div>
                );
            };

            return (
                <div className="card-container">
                    {!isFinished ? (
                        <>
                            {PHASE_ORDER.slice().reverse().map(phase => renderCard(phase))}
                        </>
                    ) : (
                        // âœ¨ ì™„ë£Œ í™”ë©´: íŒŒìŠ¤í…” ê³¨ë“œ/ì˜¤ë Œì§€ ê·¸ë¼ë°ì´ì…˜ ë° ì—¬ë°± ì¶•ì†Œ
                        <div className="card active success-card bg-gradient-to-br from-[#fcd34d] via-[#fbbf24] to-[#f59e0b] p-6 flex flex-col items-center justify-center text-[#1e3a8a]">
                            <div className="w-16 h-16 bg-white/30 text-white rounded-full flex items-center justify-center mb-3 shadow-lg backdrop-blur-md border border-white/40">
                                <IconCheck />
                            </div>
                            <h2 className="text-2xl font-extrabold mb-1 tracking-tight text-white drop-shadow-sm">Session Complete!</h2>
                            <p className="text-white/90 text-sm font-medium mb-5">Refreshed & Ready for next.</p>
                            {/* âœ¨ ë²„íŠ¼ ìƒ‰ìƒ: í…Œë§ˆì— ë§ì¶˜ ë”¥ ê³¨ë“œ/ì˜¤ë Œì§€ */}
                            <button onClick={resetAll} className="flex items-center gap-2 px-8 py-3 bg-[#b45309] hover:bg-[#92400e] text-white rounded-full text-sm font-bold shadow-xl transition-all active:scale-95">
                                <IconRefresh /> Reset Widget
                            </button>
                        </div>
                    )}
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<FocusWidget />);
    </script>
</body>
</html>

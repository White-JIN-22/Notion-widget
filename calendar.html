<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="robots" content="noindex, nofollow">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fortress Glass Calendar</title>
    
    <script src="https://unpkg.com/react@18/umd/react.development.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js" crossorigin></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>

    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700&family=Playfair+Display:wght@400;600;700&family=Roboto+Mono:wght@400;500;700&display=swap');

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            background-color: transparent;
            margin: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            overflow: hidden;
        }

        /* ğŸ§Š Fortress Glass Container */
        .widget-container {
            position: relative;
            width: 280px; 
            height: 540px;
            background: linear-gradient(180deg, rgba(224, 242, 254, 0.2) 0%, rgba(240, 249, 255, 0.1) 100%);
            backdrop-filter: blur(20px);
            border-radius: 28px;
            border: 1px solid rgba(224, 242, 254, 0.3);
            box-shadow: 0 0 40px rgba(186, 230, 253, 0.1), inset 0 0 20px rgba(224, 242, 254, 0.1);
            display: flex;
            flex-direction: column;
            overflow: hidden;
            color: #e0f2fe;
        }

        .font-serif { font-family: 'Playfair Display', serif; }
        .font-mono { font-family: 'Roboto Mono', monospace; }
        .no-scrollbar::-webkit-scrollbar { display: none; }

        /* ë‹¬ë ¥ ê·¸ë¦¬ë“œ */
        .calendar-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 2px;
            text-align: center;
        }
        
        .day-cell {
            height: 38px;
            display: flex;
            flex-direction: column; 
            justify-content: space-between;
            align-items: center;
            border-radius: 8px;
            font-size: 0.8rem;
            font-family: 'Roboto Mono', monospace;
            position: relative;
            cursor: pointer;
            padding-top: 4px;
            padding-bottom: 4px;
            transition: all 0.2s;
        }
        .day-cell:hover { background: rgba(255,255,255,0.1); }

        .day-today {
            background: rgba(224, 242, 254, 0.25) !important;
            border: 1px solid rgba(186, 230, 253, 0.4);
            box-shadow: 0 0 10px rgba(186, 230, 253, 0.15);
            font-weight: 700;
        }

        .day-selected {
            background: rgba(255, 255, 255, 0.15);
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        .dot-container { display: flex; gap: 2px; height: 5px; }
        .dot { width: 5px; height: 5px; border-radius: 50%; }

        /* ğŸ¨ Colors */
        .bg-work { background-color: #7dd3fc; box-shadow: 0 0 4px rgba(125, 211, 252, 0.6); }
        .bg-dev { background-color: #d8b4fe; box-shadow: 0 0 4px rgba(216, 180, 254, 0.6); }
        .bg-rest { background-color: #94a3b8; }
        .bg-health { background-color: #fef08a; box-shadow: 0 0 4px rgba(254, 240, 138, 0.6); }

        .text-rose-custom { color: #fda4af; }
        .text-blue-custom { color: #93c5fd; }
        .text-dim { color: #94a3b8; }

        /* ì¼ì • ë¦¬ìŠ¤íŠ¸ ì¹´ë“œ */
        .event-card {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(224, 242, 254, 0.15);
            border-radius: 14px;
            padding: 10px 14px;
            min-height: 60px; /* ë†’ì´ ê³ ì • */
            display: flex;
            align-items: center;
            transition: all 0.3s ease;
            position: relative;
        }
        
        /* ì§€ë‚œ ì¼ì • ìŠ¤íƒ€ì¼ (íˆ¬ëª…ë„) */
        .event-past {
            opacity: 0.3;
            filter: grayscale(0.6);
            border-style: dashed;
            background: transparent;
        }

        /* ë¦¬ìŠ¤íŠ¸ ì• ë‹ˆë©”ì´ì…˜ */
        .list-enter { animation: fadeIn 0.3s ease forwards; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(5px); } to { opacity: 1; transform: translateY(0); } }

        .nav-btn {
            width: 24px; height: 24px;
            display: flex; align-items: center; justify-content: center;
            border-radius: 6px;
            color: #94a3b8;
            transition: all 0.2s;
        }
        .nav-btn:hover { color: #bae6fd; background: rgba(255,255,255,0.1); }

        /* ë¦¬ìŠ¤íŠ¸ ìœ„ì•„ë˜ ì´ë™ ë²„íŠ¼ */
        .list-nav-btn {
            width: 100%;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #94a3b8;
            font-size: 10px;
            transition: all 0.2s;
            cursor: pointer;
        }
        .list-nav-btn:hover { color: #bae6fd; background: rgba(255,255,255,0.05); }
        .list-nav-btn:disabled { opacity: 0; cursor: default; }

    </style>
</head>
<body>

    <div id="root" style="width: 100%; display: flex; justify-content: center;"></div>

    <script type="text/babel">
        const { useState, useEffect, useMemo } = React;

        const Icons = {
            ChevronLeft: () => <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="3" strokeLinecap="round" strokeLinejoin="round"><path d="M15 18l-6-6 6-6"/></svg>,
            ChevronRight: () => <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="3" strokeLinecap="round" strokeLinejoin="round"><path d="M9 18l6-6-6-6"/></svg>,
            RotateCcw: () => <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2.5" strokeLinecap="round" strokeLinejoin="round"><polyline points="1 4 1 10 7 10"></polyline><path d="M3.51 15a9 9 0 1 0 2.13-9.36L1 10"></path></svg>,
            ArrowUp: () => <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="3" strokeLinecap="round" strokeLinejoin="round"><path d="m18 15-6-6-6 6"/></svg>,
            ArrowDown: () => <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="3" strokeLinecap="round" strokeLinejoin="round"><path d="m6 9 6 6 6-6"/></svg>
        };

        const App = () => {
            const today = new Date();
            const [currentDate, setCurrentDate] = useState(new Date()); 
            const [selectedDate, setSelectedDate] = useState(new Date()); 
            const [viewOffset, setViewOffset] = useState(0); // ë¦¬ìŠ¤íŠ¸ ìŠ¤í¬ë¡¤ìš© ì¸ë±ìŠ¤

            // 1. ëª©ì—… ê³µíœ´ì¼
            const holidays = {
                "2026-1-1": "ì‹ ì •",
                "2026-2-17": "ì„¤ë‚ ",
                "2026-2-18": "ì„¤ë‚ ",
                "2026-2-19": "ì„¤ë‚ ",
                "2026-3-1": "ì‚¼ì¼ì ˆ"
            };

            const isSameDay = (d1, d2) => {
                return d1.getFullYear() === d2.getFullYear() &&
                       d1.getMonth() === d2.getMonth() &&
                       d1.getDate() === d2.getDate();
            };

            const isHoliday = (year, month, day) => {
                return holidays[`${year}-${month + 1}-${day}`];
            };

            const prevMonth = () => setCurrentDate(new Date(currentDate.getFullYear(), currentDate.getMonth() - 1, 1));
            const nextMonth = () => setCurrentDate(new Date(currentDate.getFullYear(), currentDate.getMonth() + 1, 1));
            
            const goToday = () => {
                const now = new Date();
                setCurrentDate(now);
                setSelectedDate(now);
            };

            const year = currentDate.getFullYear();
            const monthNames = ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"];
            const monthStr = monthNames[currentDate.getMonth()];

            // 2. ëª©ì—… ì¼ì • ë°ì´í„° ìƒì„±ê¸°
            const getEventList = (date) => {
                const day = date.getDate();
                const list = [];
                
                // [í…ŒìŠ¤íŠ¸ìš©] ì˜¤ëŠ˜ ë‚ ì§œì— ë‹¤ì–‘í•œ ì‹œê°„ëŒ€ ì¼ì • ì¶”ê°€ (ê³¼ê±°/í˜„ì¬/ë¯¸ë˜ í…ŒìŠ¤íŠ¸)
                if (isSameDay(date, today)) {
                    list.push({ type: 'rest', title: 'ì•„ì¹¨ ëª…ìƒ', startTime: '07:00', endTime: '07:30' });
                    list.push({ type: 'work', title: 'ì˜¤ì „ íšŒì˜', startTime: '10:00', endTime: '11:00' });
                    list.push({ type: 'health', title: 'ì ì‹¬ ì‹ì‚¬ & ì‚°ì±…', startTime: '12:30', endTime: '13:30' });
                    list.push({ type: 'work', title: 'ìˆ˜ì—… ìë£Œ ì¤€ë¹„', startTime: '15:00', endTime: '17:00' });
                    list.push({ type: 'dev', title: 'ë…ì„œ ëª¨ì„', startTime: '20:00', endTime: '22:00' });
                }
                // ë‹¤ë¥¸ ë‚ ì§œ ì˜ˆì‹œ
                else if (day === 12) {
                    list.push({ type: 'health', title: 'ê±´ê°•ê²€ì§„ (ë‚´ì‹œê²½)', startTime: '14:00', endTime: '16:00' });
                }
                else if (day === 15) {
                    list.push({ type: 'work', title: 'êµ­ì–´ ìˆ˜ì—… ìë£Œ ì—…ë¡œë“œ', startTime: '19:00', endTime: '20:00' });
                    list.push({ type: 'dev', title: 'ë…ì„œ ëª¨ì„ ë°œì œ', startTime: '21:00', endTime: '22:00' });
                }
                
                // ì‹œê°„ìˆœ ì •ë ¬
                return list.sort((a, b) => a.startTime.localeCompare(b.startTime));
            };

            // 3. í˜„ì¬ ì‹œê°„ê³¼ ë¹„êµí•˜ì—¬ ìƒíƒœ íŒë³„ (past, future)
            const getEventStatus = (evt, date) => {
                const now = new Date(); // ì‹¤ì œ í˜„ì¬ ì‹œê°„
                
                // ì„ íƒëœ ë‚ ì§œê°€ ì˜¤ëŠ˜ì´ ì•„ë‹ˆë©´, ë‚ ì§œ ê¸°ì¤€ìœ¼ë¡œ ê³¼ê±°/ë¯¸ë˜ íŒë‹¨
                if (!isSameDay(date, now)) {
                    if (date < new Date(now.getFullYear(), now.getMonth(), now.getDate())) return 'past';
                    return 'future';
                }

                // ì˜¤ëŠ˜ì´ë¼ë©´ ì‹œê°„ê¹Œì§€ ë¹„êµ
                const [endH, endM] = evt.endTime.split(':').map(Number);
                const evtEnd = new Date(now.getFullYear(), now.getMonth(), now.getDate(), endH, endM);
                
                return now > evtEnd ? 'past' : 'future';
            };

            const fullEvents = useMemo(() => getEventList(selectedDate), [selectedDate]);

            // 4. ìë™ ìŠ¤í¬ë¡¤ ë¡œì§: "ë¯¸ë˜" ì¼ì • ì¤‘ ê°€ì¥ ë¹ ë¥¸ ê²ƒì´ ë§¨ ìœ„ì— ì˜¤ë„ë¡
            useEffect(() => {
                const firstFutureIndex = fullEvents.findIndex(evt => getEventStatus(evt, selectedDate) === 'future');
                if (firstFutureIndex > 0) {
                    // ë¯¸ë˜ ì¼ì •ì´ ìˆë‹¤ë©´ ê·¸ê²Œ ì²« ë²ˆì§¸ë¡œ ë³´ì´ê²Œ, ë‹¨ 3ê°œ ë‹¨ìœ„ë¼ ëë¶€ë¶„ ì²˜ë¦¬ëŠ” clamp
                    setViewOffset(Math.min(firstFutureIndex, Math.max(0, fullEvents.length - 3)));
                } else {
                    setViewOffset(0);
                }
            }, [fullEvents, selectedDate]);

            const visibleEvents = fullEvents.slice(viewOffset, viewOffset + 3);

            const handlePrev = () => setViewOffset(prev => Math.max(0, prev - 1));
            const handleNext = () => setViewOffset(prev => Math.min(fullEvents.length - 3, prev + 1));

            const getColorClass = (type) => {
                switch(type) {
                    case 'work': return 'bg-work';
                    case 'dev': return 'bg-dev';
                    case 'health': return 'bg-health'; 
                    case 'rest': return 'bg-rest';
                    default: return 'bg-slate-500';
                }
            };

            const getDayColor = (dayIdx, isHol) => {
                if (dayIdx === 0 || isHol) return 'text-rose-custom'; 
                if (dayIdx === 6) return 'text-blue-custom'; 
                return 'text-dim'; 
            };

            // ë‹¬ë ¥ìš© ì  ë°ì´í„° (ì „ì²´ ìš”ì•½)
            const getEventsForDay = (day) => {
                const d = new Date(year, currentDate.getMonth(), day);
                return getEventList(d).map(e => e.type); // íƒ€ì…ë§Œ ë°°ì—´ë¡œ ë°˜í™˜
            };

            const firstDayOfMonth = new Date(year, currentDate.getMonth(), 1);
            const daysInMonth = new Date(year, currentDate.getMonth() + 1, 0).getDate();
            const startDay = firstDayOfMonth.getDay(); 

            return (
                <div className="widget-container">
                    {/* Header (Fixed & Glass) */}
                    <div className="px-5 pt-5 pb-3 flex justify-between items-end border-b border-white/20 bg-white/5 backdrop-blur-sm z-10 shrink-0">
                        <div>
                            <div className="text-sky-300 text-[8px] font-bold tracking-widest uppercase mb-0.5 opacity-90">Calendar</div>
                            <h1 className="text-xl title-text font-serif tracking-tight text-white font-bold">
                                {monthStr} {year}
                            </h1>
                        </div>
                        <div className="flex gap-1 items-center pb-0.5">
                            <button onClick={goToday} className="nav-btn mr-1" title="Go Today"><Icons.RotateCcw /></button>
                            <button onClick={prevMonth} className="nav-btn"><Icons.ChevronLeft /></button>
                            <button onClick={nextMonth} className="nav-btn"><Icons.ChevronRight /></button>
                        </div>
                    </div>

                    {/* Scrollable Body */}
                    <div className="flex-1 px-4 pt-3 pb-0 relative overflow-hidden flex flex-col justify-between">
                        
                        {/* Calendar Grid */}
                        <div className="mb-2 shrink-0">
                            <div className="calendar-grid mb-2">
                                {['S','M','T','W','T','F','S'].map((d, i) => (
                                    <div key={i} className={`text-[10px] font-bold ${i === 0 ? 'text-rose-custom' : (i === 6 ? 'text-blue-custom' : 'text-slate-500')}`}>{d}</div>
                                ))}
                            </div>
                            
                            <div className="calendar-grid">
                                {Array.from({length: startDay}, (_, i) => <div key={`empty-${i}`}></div>)}
                                
                                {Array.from({length: daysInMonth}, (_, i) => {
                                    const day = i + 1;
                                    const thisDate = new Date(year, currentDate.getMonth(), day);
                                    const isToday = isSameDay(thisDate, today);
                                    const isSelected = isSameDay(thisDate, selectedDate);
                                    const eventTypes = getEventsForDay(day);
                                    // ì¤‘ë³µ ì œê±° ë° ìµœëŒ€ 3ê°œ ì ë§Œ í‘œì‹œ
                                    const uniqueTypes = [...new Set(eventTypes)].slice(0, 3);
                                    const isHol = isHoliday(year, currentDate.getMonth(), day);
                                    const dayOfWeek = thisDate.getDay();

                                    let numColor = getDayColor(dayOfWeek, isHol);
                                    if (isToday) numColor = 'text-sky-300';
                                    if (isSelected && !isToday) numColor = 'text-white';

                                    return (
                                        <div 
                                            key={day} 
                                            onClick={() => setSelectedDate(thisDate)}
                                            className={`day-cell ${isToday ? 'day-today' : ''} ${isSelected && !isToday ? 'day-selected' : ''}`}
                                        >
                                            <span className={`z-10 font-bold ${numColor}`}>{day}</span>
                                            
                                            <div className="dot-container">
                                                {uniqueTypes.map((type, idx) => (
                                                    <div key={idx} className={`dot ${getColorClass(type)}`}></div>
                                                ))}
                                            </div>
                                        </div>
                                    )
                                })}
                            </div>
                        </div>

                        {/* Events List (3 items max) */}
                        <div className="flex-1 flex flex-col justify-center border-t border-white/10 relative">
                            
                            {/* Up Button */}
                            <button 
                                onClick={handlePrev} 
                                disabled={viewOffset === 0} 
                                className="list-nav-btn"
                            >
                                {viewOffset > 0 && <Icons.ArrowUp />}
                            </button>

                            <div className="space-y-1 h-[190px]"> {/* 3ê°œ ì•„ì´í…œ ë†’ì´ ê³ ì • */}
                                {visibleEvents.length === 0 ? (
                                    <div className="h-full flex items-center justify-center text-dim text-xs italic opacity-60">ì¼ì •ì´ ì—†ìŠµë‹ˆë‹¤.</div>
                                ) : (
                                    visibleEvents.map((evt, idx) => {
                                        const status = getEventStatus(evt, selectedDate);
                                        const isPast = status === 'past';
                                        
                                        return (
                                            <div key={idx} className={`event-card list-enter ${isPast ? 'event-past' : ''}`}>
                                                <div className={`w-1.5 h-8 rounded-full mr-3 shrink-0 ${getColorClass(evt.type)}`}></div>
                                                <div>
                                                    <div className={`text-xs font-bold mb-0.5 ${isPast ? 'text-slate-300' : 'text-white'}`}>{evt.title}</div>
                                                    <div className={`text-[10px] font-mono ${isPast ? 'text-slate-500' : 'text-slate-400'}`}>
                                                        {evt.startTime} - {evt.endTime}
                                                    </div>
                                                </div>
                                            </div>
                                        );
                                    })
                                )}
                            </div>

                            {/* Down Button */}
                            <button 
                                onClick={handleNext} 
                                disabled={viewOffset + 3 >= fullEvents.length} 
                                className="list-nav-btn"
                            >
                                {viewOffset + 3 < fullEvents.length && <Icons.ArrowDown />}
                            </button>

                        </div>

                    </div>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>

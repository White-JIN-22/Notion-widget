<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Weekly Timetable (Glass v34)</title>
<style>
  body {
    background: #0e0e0e;
    font-family: 'Pretendard', sans-serif;
    color: #f0f0f0;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: flex-start;
    height: 100vh;
    margin: 0;
  }

  .top-bar {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 12px;
    margin-top: 24px;
  }

  .nav-btn {
    background: rgba(255, 255, 255, 0.08);
    color: #ddd;
    border: none;
    padding: 8px 14px;
    border-radius: 12px;
    cursor: pointer;
    backdrop-filter: blur(8px);
    transition: all 0.2s ease;
  }

  .nav-btn:hover {
    background: rgba(255, 255, 255, 0.15);
  }

  .week-label {
    font-size: 18px;
    font-weight: 500;
    color: #ccc;
    background: rgba(255,255,255,0.08);
    padding: 6px 18px;
    border-radius: 14px;
    backdrop-filter: blur(6px);
  }

  .timetable {
    display: grid;
    grid-template-columns: repeat(7, 1fr);
    position: relative;
    width: 80vw;
    max-width: 850px;
    height: 84vh;
    margin-top: 24px;
    border-radius: 24px;
    background: rgba(255, 255, 255, 0.04);
    box-shadow: inset 0 0 15px rgba(255,255,255,0.05);
    overflow: hidden;
    backdrop-filter: blur(20px);
  }

  .day-header {
    text-align: center;
    padding: 12px 0;
    font-weight: 600;
    border-bottom: 1px solid rgba(255, 255, 255, 0.05);
    white-space: pre-line;
  }

  .hour-line {
    position: absolute;
    left: 0;
    width: 100%;
    border-top: 1px solid rgba(255,255,255,0.06);
  }

  .hour-label {
    position: absolute;
    left: -38px;
    font-size: 14px;
    color: #aaa;
  }

  .major-line {
    border-top: 2px solid rgba(255,255,255,0.15);
  }

  .event-block {
    position: absolute;
    width: calc(100% / 7 - 8px);
    margin-left: 4px;
    border-radius: 12px;
    backdrop-filter: blur(6px);
    opacity: 0.9;
    color: white;
    font-size: 12px;
    display: flex;
    align-items: center;
    justify-content: center;
    text-align: center;
    padding: 4px;
    transition: transform 0.15s ease;
  }

  .event-block:hover {
    transform: scale(1.05);
  }

  .tooltip {
    position: absolute;
    background: rgba(0, 0, 0, 0.75);
    padding: 6px 10px;
    border-radius: 8px;
    font-size: 12px;
    pointer-events: none;
    color: white;
    transform: translate(-50%, -110%);
  }
</style>
</head>
<body>

<div class="top-bar">
  <button class="nav-btn" id="prevWeek">←</button>
  <div class="week-label" id="weekLabel">Dec 1 - 7</div>
  <button class="nav-btn" id="nextWeek">→</button>
  <button class="nav-btn" id="thisWeek">THIS WEEK</button>
</div>

<div class="timetable" id="timetable"></div>

<script>
const timetable = document.getElementById("timetable");
let currentMonday = getMonday(new Date());

function getMonday(d) {
  d = new Date(d);
  const day = d.getDay(),
        diff = d.getDate() - day + (day === 0 ? -6 : 1);
  return new Date(d.setDate(diff));
}

function getFixedKoreanHolidays(year) {
  return {
    [`${year}-01-01`]: "신정",
    [`${year}-03-01`]: "삼일절",
    [`${year}-05-05`]: "어린이날",
    [`${year}-06-06`]: "현충일",
    [`${year}-08-15`]: "광복절",
    [`${year}-10-03`]: "개천절",
    [`${year}-10-09`]: "한글날",
    [`${year}-12-25`]: "크리스마스",
  };
}

function renderWeek(monday) {
  timetable.innerHTML = "";
  const weekLabel = document.getElementById("weekLabel");
  const start = new Date(monday);
  const end = new Date(monday);
  end.setDate(end.getDate() + 6);
  weekLabel.textContent = `${start.toLocaleString('en-US', { month: 'short', day: 'numeric' })} - ${end.toLocaleString('en-US', { month: 'short', day: 'numeric' })}`;

  const days = ["MON", "TUE", "WED", "THU", "FRI", "SAT", "SUN"];
  const today = new Date();
  const todayIndex = (today.getDay() + 6) % 7;
  const holidays = getFixedKoreanHolidays(monday.getFullYear());

  days.forEach((d, i) => {
    const head = document.createElement("div");
    head.className = "day-header" + (i === todayIndex ? " today" : "");
    const date = new Date(monday);
    date.setDate(monday.getDate() + i);
    const dateStr = `${String(date.getMonth()+1).padStart(2,"0")}/${String(date.getDate()).padStart(2,"0")}\n${d}`;
    head.textContent = dateStr;

    const dateKey = date.toISOString().split("T")[0];
    const isSunday = i === 6;
    const isHoliday = holidays[dateKey];

    if (isHoliday) {
      head.style.color = "rgba(255,150,120,0.9)";
      head.style.textShadow = "0 0 6px rgba(255,150,120,0.3)";
    } else if (isSunday) {
      head.style.color = "#ffffff";
    }

    timetable.appendChild(head);
  });

  // 시간 라인 (06~24 동일 간격)
  for (let h = 6; h <= 24; h++) {
    const line = document.createElement("div");
    line.className = "hour-line" + ((h % 6 === 0) ? " major-line" : "");
    line.style.top = `${((h - 6) / 18) * 100}%`;
    timetable.appendChild(line);

    const label = document.createElement("div");
    label.className = "hour-label";
    label.style.top = `${((h - 6) / 18) * 100}%`;
    label.textContent = h.toString().padStart(2,"0");
    timetable.appendChild(label);
  }

  // 테스트용 블록 (실제엔 iCal 데이터로 대체)
  const sampleEvents = [
    { title: "자기계발이다!", start: 11, end: 12, day: 1, color: "#b2c0d2" },
    { title: "심리상담", start: 14, end: 15, day: 1, color: "#cecbd3" },
    { title: "업무", start: 16, end: 17, day: 1, color: "#3d547f" },
    { title: "휴식", start: 23, end: 24, day: 1, color: "#f3f1eb" },
  ];

  sampleEvents.forEach(ev => {
    const block = document.createElement("div");
    block.className = "event-block";
    block.style.background = ev.color;
    block.style.left = `calc(${(ev.day) * (100 / 7)}% + 4px)`;
    block.style.top = `${((ev.start - 6) / 18) * 100}%`;
    block.style.height = `${((ev.end - ev.start) / 18) * 100}%`;
    block.textContent = ev.title;
    timetable.appendChild(block);
  });
}

// 버튼 동작
document.getElementById("prevWeek").addEventListener("click", () => {
  currentMonday.setDate(currentMonday.getDate() - 7);
  renderWeek(currentMonday);
});
document.getElementById("nextWeek").addEventListener("click", () => {
  currentMonday.setDate(currentMonday.getDate() + 7);
  renderWeek(currentMonday);
});
document.getElementById("thisWeek").addEventListener("click", () => {
  currentMonday = getMonday(new Date());
  renderWeek(currentMonday);
});

renderWeek(currentMonday);
</script>
</body>
</html>

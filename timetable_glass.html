<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Weekly Timetable (Glass v35)</title>
<style>
  body {
    background: #0d0d0d;
    font-family: 'Pretendard', sans-serif;
    color: #f1f1f1;
    display: flex;
    flex-direction: column;
    align-items: center;
    margin: 0;
    height: 100vh;
  }

  /* 상단 구조 */
  .top-controls {
    display: flex;
    align-items: center;
    justify-content: center;
    margin-top: 20px;
    gap: 10px;
  }

  .nav-btn {
    background: rgba(255, 255, 255, 0.08);
    border: none;
    padding: 8px 14px;
    border-radius: 12px;
    color: #ddd;
    cursor: pointer;
    backdrop-filter: blur(8px);
    transition: all 0.2s ease;
  }
  .nav-btn:hover {
    background: rgba(255, 255, 255, 0.15);
  }

  .week-label {
    font-size: 18px;
    font-weight: 500;
    background: rgba(255, 255, 255, 0.08);
    padding: 6px 18px;
    border-radius: 14px;
    backdrop-filter: blur(6px);
  }

  .this-week {
    background: rgba(255, 255, 255, 0.15);
    color: #eee;
    border-radius: 14px;
    padding: 6px 18px;
    margin-bottom: 12px;
  }

  /* 타임테이블 영역 */
  .timetable {
    display: grid;
    grid-template-columns: repeat(7, 1fr);
    width: 80vw;
    max-width: 850px;
    height: 84vh;
    background: rgba(255, 255, 255, 0.04);
    border-radius: 24px;
    position: relative;
    overflow: hidden;
    box-shadow: inset 0 0 20px rgba(255,255,255,0.04);
    margin-top: 10px;
  }

  .day-header {
    text-align: center;
    padding: 10px 0;
    font-weight: 600;
    border-bottom: 1px solid rgba(255,255,255,0.06);
    white-space: pre-line;
    background: rgba(255,255,255,0.07);
    border-radius: 12px;
    margin: 4px;
    backdrop-filter: blur(10px);
  }

  .hour-line {
    position: absolute;
    left: 0;
    width: 100%;
    border-top: 1px solid rgba(255,255,255,0.06);
  }

  .major-line {
    border-top: 2px solid rgba(255,255,255,0.2);
  }

  .hour-label {
    position: absolute;
    left: -38px;
    font-size: 14px;
    color: #aaa;
  }

  .event-block {
    position: absolute;
    width: calc(100% / 7 - 8px);
    margin-left: 4px;
    border-radius: 12px;
    backdrop-filter: blur(6px);
    opacity: 0.9;
    transition: transform 0.15s ease;
  }

  .event-block:hover {
    transform: scale(1.05);
  }

  .tooltip {
    position: absolute;
    background: rgba(0, 0, 0, 0.75);
    padding: 6px 10px;
    border-radius: 8px;
    font-size: 12px;
    pointer-events: none;
    color: white;
    transform: translate(-50%, -110%);
  }
</style>
</head>
<body>

<button class="this-week" id="thisWeek">THIS WEEK</button>

<div class="top-controls">
  <button class="nav-btn" id="prevWeek">←</button>
  <div class="week-label" id="weekLabel">(2025) 49주차 / 52주</div>
  <button class="nav-btn" id="nextWeek">→</button>
</div>

<div class="timetable" id="timetable"></div>

<script>
const timetable = document.getElementById("timetable");
let currentMonday = getMonday(new Date());

function getMonday(d) {
  d = new Date(d);
  const day = d.getDay(),
        diff = d.getDate() - day + (day === 0 ? -6 : 1);
  return new Date(d.setDate(diff));
}

function getWeekNumber(d) {
  const date = new Date(Date.UTC(d.getFullYear(), d.getMonth(), d.getDate()));
  const dayNum = date.getUTCDay() || 7;
  date.setUTCDate(date.getUTCDate() + 4 - dayNum);
  const yearStart = new Date(Date.UTC(date.getUTCFullYear(), 0, 1));
  const weekNo = Math.ceil((((date - yearStart) / 86400000) + 1) / 7);
  return weekNo;
}

function getFixedKoreanHolidays(year) {
  return {
    [`${year}-01-01`]: "신정",
    [`${year}-03-01`]: "삼일절",
    [`${year}-05-05`]: "어린이날",
    [`${year}-06-06`]: "현충일",
    [`${year}-08-15`]: "광복절",
    [`${year}-10-03`]: "개천절",
    [`${year}-10-09`]: "한글날",
    [`${year}-12-25`]: "크리스마스",
  };
}

function renderWeek(monday) {
  timetable.innerHTML = "";
  const weekLabel = document.getElementById("weekLabel");
  const start = new Date(monday);
  const weekNum = getWeekNumber(start);
  const year = start.getFullYear();
  weekLabel.textContent = `(${year}) ${weekNum}주차 / 52주`;

  const days = ["MON", "TUE", "WED", "THU", "FRI", "SAT", "SUN"];
  const today = new Date();
  const todayIndex = (today.getDay() + 6) % 7;
  const holidays = getFixedKoreanHolidays(monday.getFullYear());

  days.forEach((d, i) => {
    const head = document.createElement("div");
    head.className = "day-header" + (i === todayIndex ? " today" : "");
    const date = new Date(monday);
    date.setDate(monday.getDate() + i);
    const dateStr = `${String(date.getMonth()+1).padStart(2,"0")}/${String(date.getDate()).padStart(2,"0")}\n${d}`;
    head.textContent = dateStr;

    const dateKey = date.toISOString().split("T")[0];
    const isSunday = i === 6;
    const isHoliday = holidays[dateKey];

    if (isHoliday) {
      head.style.color = "rgba(255,150,120,0.9)";
      head.style.textShadow = "0 0 6px rgba(255,150,120,0.3)";
    } else if (isSunday) {
      head.style.color = "#ffffff";
    }

    timetable.appendChild(head);
  });

  for (let h = 6; h <= 24; h++) {
    const line = document.createElement("div");
    line.className = "hour-line" + ((h % 6 === 0) ? " major-line" : "");
    line.style.top = `${((h - 6) / 18) * 100}%`;
    timetable.appendChild(line);

    if (h % 6 === 0) {
      const label = document.createElement("div");
      label.className = "hour-label";
      label.style.top = `${((h - 6) / 18) * 100}%`;
      label.textContent = h.toString().padStart(2,"0");
      timetable.appendChild(label);
    }
  }

  // 예시 일정
  const events = [
    { title: "자기계발", start: 11, end: 12, day: 1, color: "#b2c0d2" },
    { title: "심리상담", start: 14, end: 15, day: 1, color: "#cecbd3" },
    { title: "업무", start: 16, end: 17, day: 1, color: "#3d547f" },
    { title: "휴식", start: 23, end: 24, day: 1, color: "#f3f1eb" },
  ];

  events.forEach(ev => {
    const block = document.createElement("div");
    block.className = "event-block";
    block.style.background = ev.color;
    block.style.left = `calc(${(ev.day) * (100 / 7)}% + 4px)`;
    block.style.top = `${((ev.start - 6) / 18) * 100}%`;
    block.style.height = `${((ev.end - ev.start) / 18) * 100}%`;

    const tooltip = document.createElement("div");
    tooltip.className = "tooltip";
    tooltip.textContent = `${ev.start}:00 ~ ${ev.end}:00 ${ev.title}`;
    tooltip.style.display = "none";
    block.appendChild(tooltip);

    block.addEventListener("mouseenter", () => tooltip.style.display = "block");
    block.addEventListener("mouseleave", () => tooltip.style.display = "none");

    timetable.appendChild(block);
  });
}

document.getElementById("prevWeek").addEventListener("click", () => {
  currentMonday.setDate(currentMonday.getDate() - 7);
  renderWeek(currentMonday);
});
document.getElementById("nextWeek").addEventListener("click", () => {
  currentMonday.setDate(currentMonday.getDate() + 7);
  renderWeek(currentMonday);
});
document.getElementById("thisWeek").addEventListener("click", () => {
  currentMonday = getMonday(new Date());
  renderWeek(currentMonday);
});

renderWeek(currentMonday);
</script>
</body>
</html>
